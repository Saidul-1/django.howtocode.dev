# মডেল তৈরি

আমাদের লক্ষ্য হল, কেউ যদি আমাদের ওয়েবসাইটে আসে তাহলে তাকে শুধু Hello World! না দেখিয়ে এর সাথে একটা মেসেজও দেখাবো। আমরা কয়েকটি টেক্সট মেসেজ ডাটাবেইজে সেভ করে রাখব, আর ভিজিটরকে র‍্যান্ডম ভাবে একেক সময় একেকটা মেসেজ দেখাব। যেমন Hello World! Today is Beautiful Day! অথবা Hello World! Nice To Meet You!

এই মেসেজগুলো লিখতে হলে আমাদেরকে ডাটাবেইজে একটা টেবিল তৈরি করতে হবে, টেবিল তৈরি করতে প্রথমে আপনার অ্যাপ \(myapp\) ফোল্ডারের models.py ফাইলটি কোন টেক্সট এডিটরে ওপেন করুন। সেখানে এরকম দুটি লাইন দেখা যাবে।

```text
from django.db import models

# Create your models here.
```

প্রথম লাইনে models মডিউল ইম্পোর্ট করা হয়েছে। ওআরএম চ্যাপ্টারে আমরা বলেছি যে ডাটাবেইজের টেবিল/কলাম তৈরি করব অবজেক্ট অরিয়েন্টেড কোড দিয়ে, অর্থাৎ ক্লাস লিখে। আমাদের একেকটা টেবিল হবে একেকটা ক্লাস, ক্লাসের এট্রিবিউট গুলো হবে টেবিলের কলাম! আর হ্যা, আমাদের সকল মডেল ক্লাসগুলোই উপরে ইম্পর্ট করা models.Model এর সাবক্লাস হবে।

ব্যপারটা কঠিন লাগছে? আসুন কোডে চলে যাই, আমাদের সাইটের মেসেজ গুলো রাখার জন্য প্রথমে আমরা Message নামে একটা ক্লাস তৈরি করব, models.py ফাইলে \(`# Create your models here.` কমেন্টটার পর\) লিখুনঃ

```text
class Message(models.Model):
```

আমরা Message নামে ক্লাস তৈরি করলাম, এটাকেই আমাদের ডাটাবেইজ টেবিল হিসেবে ধরে নিতে পারেন, আমাদের ক্লাসটি models.Model এর সাবক্লাস করলাম, এতে আমাদের ক্লাসে প্রয়োজনীয় কিছু এট্রিবিউট/মেথড যুক্ত হবে।

এর পর লিখুনঃ

```text
text = models.TextField()
```

আমরা text নামে একটা এট্রিবিউট লিখলাম, যার ভ্যালু হল `models.TextField` অবজেক্ট! `TextField` দ্বারা বোঝাচ্ছে যে ডাটাবেইজে এই কলামের ফিল্ড/রো গুলো টেক্সট টাইপের হবে, পাইথনের স্ট্রিং গুলোই ডাটাবেইজ টেক্সট হিসেবে থাকবে।

মাথা গরম করার দরকার নেই, এটা ওআরএম এর সুবিধা/বৈশিষ্ট! উপরের কোডটির বাংলা অনুবাদটা মোটামোটি এরকমঃ

‘ওহে ডাটাবেইজ, তুমি Message নামক টেবিলে text নামে একটা কলাম তৈরি কর, যে কলামটাতে রো/ফিল্ড হিসেবে টেক্সট/স্ট্রিং টাইপ ভ্যালু থাকবে’

এর পর আমাদেরকে __str__\(\) ম্যাজিক মেথড ওভাররাইট করতে হবেঃ

```text
def __str__(self):
    return self.text
```

বুঝতেই পারছেন, এই মেথডের কারনে এখন Message ক্লাসের অবজেক্টগুলোকে print করলে সেই অবজেক্টের text ফিল্ডের ভ্যালু দেখা যাবে!

আমাদের Message মডেল তৈরি হয়ে গেল। একনজরে models.py ফাইলঃ

```text
from django.db import models

# Create your models here.
class Message(models.Model):
    text = models.TextField()

    def __str__(self):
        return self.text  
```

মডেল তৈরি হল, ডাটাবেইজ কিন্তু এখনো তৈরি হয়নি... এই মডেল অনুযায়ী ডাটাবেইজ তৈরি করতে আমাদেরকে manage.py ফাইলের দুটি কমান্ড এর সাথে পরিচিত হতে হবে।

## makemigrations

প্রতিবারই আপনি কোন মডেল তৈরি করলে অথবা মডেলের কোন ফিল্ড \(এট্রিবিউট\) পরিবর্তন করলে আপনাকে কমান্ড প্রম্পট বা টার্মিনালে

`python manage.py makemigrations`

কমান্ডটি দিতে হবে। এতে করে আপনার অ্যাপ ফোল্ডারে \(আমাদের myapp ফোল্ডারে\) থাকা migrations ফোল্ডারে একটি মাইগ্রেশন নাম্বার যুক্ত পাইথন ফাইল তৈরি হবে। সেই ফাইলের ভিতরে যে কোডগুলো থাকবে সেটা আসলে আপনার ডাটাবেইজ এর সিকুয়েল কোড কেমন হবে তারই একটা প্রতিরূপ! এর উপর ভিত্তি করেই আপনার ডাটাবেইজ টেবিল/কলাম/ডাটা তৈরি হবে। আপনি সিকুয়েল ভালো পারলে এখানে আপনার চাহিদা অনুযায়ী পরিবর্তন করতে পারবেন। মাইগ্রেশনের উল্লেখযোগ্য আরেকটা সুবিধা হল, প্রতিবার মডেল আপডেট করে `makemigrations` কমান্ড দিলে প্রতিবারই migrations ফোল্ডারে নতুন একটা ফাইল তৈরি হয়, যেটা ভার্শন কন্ট্রোল করাতে খুবই কাজের, অর্থাৎ আপনি যদি ভুলে ডাটাবেইজ আপডেট করেন তাহলে ব্যাক করে আগের অবস্থায় ফিরে যেতে পারবেন।

`makemigrations` কমান্ড দেয়ার পরও কিন্তু আপনার ডাটাবেইজ তৈরি হয়নি, আসল ডাটাবেইজ তৈরি হবে migrate কমান্ড দিলে।

## migrate

মাইগ্রেশন তৈরি করার পর তা অনুযায়ী ডাটাবেইজ তৈরি করতে

```text
python manage.py migrate 
```

কমান্ডটি দিতে হবে। এটাই আপনার ডাটাবেইজ তৈরি/আপডেট করে দিবে।

> লক্ষ্য করুন, প্রতিবার models.py তে মডেল যুক্ত বা আপডেট করলে ডাটাবেইজে সেটা ইমপ্লিমেন্ট করতে টার্মিনালে `python manage.py makemigrations` এবং `python manage.py migrate` কমান্ড দুটি দিতে হবে।

`makemigrations` কমান্ড কিন্তু ডাটাবেইজ তৈরি/আপডেট করেনা, শুধু একটা মাইগ্রেশন ফাইল তৈরি করে। এরপর migrate কমান্ডটা সেই মাইগ্রেশনের উপর ভিত্তি করে আসল ডাটাবেইজ তৈরি/আপডেট করে।

আমাদের মডেল তৈরি হল এবং ডাটাবেইজও রেডি হয়ে গেলে... এখন ডাটাবেইজে ডাটা রাখতে হবে... এখন পরিচিত হওয়ার সময় এসেছে জ্যাঙ্গো শেল এর সাথে... জ্যাঙ্গো শেল... নাম শুনে কি ভয় লাগছে !!??

